<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by TEMPLATED
http://templated.co
Released for free under the Creative Commons Attribution License

Name       : ColoreGiallo 
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20121026

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>GEF4530 - Practicals D1 - LAPTOP SETUP</title>
<link href='http://fonts.googleapis.com/css?family=Oswald:400,300' rel='stylesheet' type='text/css' />
<link href='http://fonts.googleapis.com/css?family=Abel|Satisfy' rel='stylesheet' type='text/css' />
<link href="../../style.css" rel="stylesheet" type="text/css" media="screen" />
</head>
<body>
<img src="../../images/laptop_setup.jpg" align="middle" width="600" alt="" />
<br>
<br>
<ul>
<li><a href="#Remote">Check Remote Connection</a></li>
  <ul>
    <li><a href="#Linux" >From a Linux laptop</a></li>
    <li><a href="#Mac">From a Mac laptop</a></li>
    <li><a href="#Windows">From a Windows laptop</a></li>
  </ul>
<li><a href="#Login">Check access to Notur Computing facility (Abel) and NorStore (cruncher, viz2)</a></li>
<li><a href="#SSH_keys">Check for SSH keys</a></li>
<li><a href="#Analysis">Check Post-processing and Visualization Software</a></li>
<li><a href="#Visualization">Setup for Remote Visualization (viz2)</a></li>
</ul>
<hr>
<br>
<br>
<h2 id="Remote">Check Remote Connection</h2>

To be able to connect to the High-performance Computing Machine where CAM-5.3 (Abel) will be run and on the norStore facility (cruncher, viz2) to post-process your model results, you need to be able to run Remote X11 applications.
<br>
<br>
<h3 id="Linux" >From a Linux laptop</h3>
The tool on Linux for connecting to a remote system using SSH is called, unsurprisingly, ssh.
<p> Launch a terminal from your desktopâ€™s application menu and you will see the bash shell. There are other shells, but most Linux distributions use bash by default.</p>
<img src="../../images/linux_terminal.png" width="600" alt="" />
<br>
Then check you can <a href="#Login">login both on Abel (HPC computing facility) and Cruncher (norstore storage facility)</a>.
<br>
<br>
<i><b>Please report any problems.</b></i>
<br>
<br>
<h3 id="Mac">From a Mac laptop</h3>
If you haven't done it yet, install xcode:
<ul>
   <li> xcode can be installed by going to the App Store. You need to install xcode, then goto the top left of your screen and click XCode -> Preferences -> Downloads, find "command line tools" and click install.
   </li>
   <li> xcode is a 1GB+ download so you will not have time to download it in class Monday.
   </li>
   <li>
    Note that the current version of xcode is only supported by OSX 10.7.4+ so we highly recommend you upgrade your operating system. If for whatever reason you absolutely cannot upgrade your os, you need to register for a free Apple developer account and download the appropriate version of xcode
   </li>
</ul>
Mac OS X has a built-in SSH client called Terminal which can be used to connect to remote servers. By default, Terminal.app is located in Applications -> Utilities folder. Double-click on the icon to start the client.

Then check you can <a href="#Login">login both on Abel (HPC computing facility) and Cruncher (norstore storage facility)</a>.
<br>
<i><b>Please report any problems.</b></i>
<br>
<br>
<h3 id="Windows">From a Windows laptop</h3>

Here we assume you wish to use your personal laptop (not UIO laptop) and have administrator privileges.        
<br>
If you have a UIO laptop, all the necessary packages for running remote X11 applications are already installed and ready to use. Ask your administrator if you need help. 
<br>
<br>
For running remote X11 applications from Windows the easiest is to install <a href="http://www.mn.uio.no/geo/english/services/it/help/using-linux/x2go.html">X2Go Client</a>. You can download it <a href="http://code.x2go.org/releases/binary-win32/x2goclient/releases/4.0.5.0-2015.07.31/">here</a>.
<br>
<br>
    Once installed, double click on the X2Go shortcut on the desktop (see figure below)
<br>
<img src="../../images/x11-logo.png" alt="" />
<br>
A session preference window will pop up and you should fill it with the following information:
<ul>
<li>Session name: sverdrup</li>
<li>Host        : sverdrup.uio.no</li>
<li>Login       : annefou (please use your own username!)</li>
</ul>
<br>
<img src="../../images/x2go_preferences.png" alt="" />
<br>
There are many "Session types" to choose from. We recommend a KDE session. Use your UIO password and open a connection on sverdrup. 
<br>
<b>Note</b>: If you have a firewall installed on your computer you will need to allow remote hosts access to the X-server.
<br>
<i><b>Please report any problems.</b></i>
Then open a terminal and check you can <a href="#Login">login both on Abel (HPC computing facility) and Cruncher (norstore storage facility)</a>.
<br>
<br>
<h2 id="Login">Login to Notur (Abel) and NorStore (cruncher, viz2)</h2>
<br>
In this section, you should check you can access both <a href="https://docs.hpc.uib.no/wiki/Main_Page">Abel</a> (where you will run <a href="">CAM-5</a>) and <a href="https://www.sigma2.no/content/norstore-services">Cruncher</a> (where you will pos t-process and visualize the results of your model runs).
<code>
<pre>
ssh -Y $LOGNAME@abel.uio.no
</pre>
</code>
where $LOGNAME is your UIO username (replace it by your own username!)
<br>
More documentation on abel can be found <a href="http://www.uio.no/english/services/it/research/hpc/abel/">here</a>.
<br>
<br>
Post-processing will be performed on NorStore facility cruncher.norstore.uio.no:
<code>
<pre>
ssh -Y $LOGNAME@cruncher.norstore.uio.no
</pre>
</code>
where $LOGNAME is your UIO username (replace it by your own username!)
<br>
<br>
For visualization, you may use cruncher but the most suitable machine is called viz2. Check first that you have access to the machine:
<code>
<pre>
ssh -Y $LOGNAME@viz2.norstore.uio.no
</pre>
</code>
<br>
Report any problems, in particular if you don't have access to viz2. 
<br>
<b>Once you know you have access to viz2.norstore.uio.no, you will never login to this machine with ssh. We will give you scripts to make use of the GPUs and quickly visualize your data from your laptop or local machine</b>.
<br>
To use viz2, you need to install turboVNC on your laptop (make sure you take the exact version we give so you can connect to the mahine):
<ul>
<li>http://sourceforge.net/projects/turbovnc/files/2.0.1/</li>
<li>Make sure your ssh keys are properly set-up (otherwise you will have to enter your password many times!)</li>
</ul>
<br>
Documentation on norStore facility can be found <a href="https://www.sigma2.no/node/8">here</a>.
<br>
<br>
Please note that these machines are not accessible outside the UIO networks. If you wish to login on abel or cruncher outside the UIO network, use 
<a href="http://www.mn.uio.no/geo/english/services/it/help/using-linux/x2go.html">X2Go Client</a>. 
<br>
<br>
<h2 id="SSH_keys">Check your SSH keys</h2>
<br>
To automate file transfers between norStore and Notur facilities with scp (Secure Copy), you need to be able to remotely copy files over SSH without entering your password.
<br>
Information on how to generate SSH keys and automate transfers can be found <a href="http://www.mn.uio.no/geo/english/services/it/help/using-linux/ssh-tips-and-tricks.html">here</a>.
<br>
<br>
<h2 id="Analysis">Check Post-processing and Visualization Software</h2>
<br>
On norStore (cruncher.norstore.uio.no, viz2.norstore.uio.no), we will be using the following tools for post-processing and visualize the results of CAM-5 simulations:
<ul>
<li><a href="https://code.zmaw.de/projects/cdo">CDO (Climate Data operators)</a></li> 
<li><a href="https://www.ncl.ucar.edu/index.shtml">NCL (Ncar Command Language)</a></li>
<li><a href="http://nco.sourceforge.net/">NCO (netCDF Operators)</a></li>
<li><a href="http://www.giss.nasa.gov/tools/panoply/">Panoply netCDF, HDF and GRIB Data Viewer</a></li>
<li><a href="http://meteora.ucsd.edu/~pierce/ncview_home_page.html">Ncview: a netCDF visual browser</a></li>
<li><a href="http://www.giss.nasa.gov/tools/panoply/">Panoply netCDF Data Viewer</a></li>
<li><a href="https://www.continuum.io/downloads">Python programming language using NetCDF4, Xarray and matplotlib</a></li>
</ul>
<br>
These packages are already installed on cruncher and more information on how to use them is detailed in the <a href="../../results.html">Results</a> section.
<br>
<br>
<br>
<h2 id="Visualization">Setup for Remote Visualization (viz2)</h2>
<br>
<b>Requirements</b>
<ol>
<li>Get access to viz2.norstore.uio.no (all GEF4530 students should have access to this machine)</li>
<li><b>ssh</b>. It is available on all machines at UIO. If you wish to use your laptop, make sure it installed (on Windows, install <a href="https://git-scm.com/downloads">git bash</a>)</li>
<li><b><a href="#turboVNC_viz2">TurboVNC 2.0.1</a></b>. It is available on all student machines in Room 209 and on all METOS student machines but if you wish to visualize your data from your laptop, install on your machine turbovnc 2.0.1 (<a href="http://sourceforge.net/projects/turbovnc/files/2.0.1/">http://sourceforge.net/projects/turbovnc/files/2.0.1/</a>). Contact us if you need any help.</li>
<li><b><a href="#ssh_keys_viz2">SSH keys</a></b>: make sure your public key (on your laptop) is known from viz2.norstore.uio.no.
</ol>
<br>
<h4 id="ssh_keys_viz2">SSH keys for viz2 (visualization)</h4>
<br>
To automate transfer between abel and norstore, you have set-up your SSH keys (see <a href="#SSH_keys">here</a>).
<br>
To be able to visualize your data using the norStore remote visualization facility (viz2), your SSH public key (from your laptop/local desktop) needs to be available on viz2:
<ol>
<li><b>Check your public key on your local desktop/laptop</b>:
<br>
<code>
<pre>
ls $HOME/.ssh
</pre>
</code>
This command should return something like:
<code>
<pre>
authorized_keys  id_rsa  id_rsa.pub  known_hosts
</pre>
</code>
If you have files called "id_rsa" and "id_rsa.pub" then skip step 2. Otherwise create new SSH keys:
<li><b>Create SSH keys</b>:</li>
<code>
<pre>
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
</pre>
</code>
Make sure you fill your email address correctly. For more information see <a href="https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/">here</a>.
<li><b>Add your new SSH key to viz2.norstore.uio.no</b>:</li>
<ul>
<li>Copy the public key to viz2.norstore.uio.no:</li>
<code>
<pre>
  scp .ssh/id_rsa.pub viz2.norstore.uio.no:tmp.key
</pre>
</code>
<li>On the viz2.norstore.uio.no add the key to the file .ssh/authorized_keys:</li>
<code>
<pre>
  ssh viz2.norstore.uio.no "cat tmp.key >> .ssh/authorized_keys ; rm tmp.key"
</pre>
</code>
<ul>
</ol>
<br>
<br>
<h4 id="turboVNC_viz2">Install TurboVNC (visualization)</h4>
<br>
This step is required if you wish to visualize your data from your laptop (TurboVNC is already installed at UIO).
<br>
<ul>
<li>Linux Fedora, Redhat, Centos distribution:</li>
<br>
<code>
<pre>
wget https://sourceforge.net/projects/turbovnc/files/2.0.1/turbovnc-2.0.1.x86_64.rpm/download

sudo rpm -Uvh turbovnc-2.0.1.x86_64.rpm

ls -lrt  /opt/TurboVNC/bin/vncviewer

-rwxr-xr-x. 1 root root 1523 Nov  5  2015 /opt/TurboVNC/bin/vncviewer
</pre>
</code>
<br>
<code>
<li>Ubuntu distribution</li>
<br>
<code>
<pre>
wget https://sourceforge.net/projects/turbovnc/files/2.0.1/turbovnc_2.0.1_amd64.deb/download

sudo dpkg -i turbovnc_2.0.1_amd64.deb

ls -lrt  /opt/TurboVNC/bin/vncviewer

-rwxr-xr-x. 1 root root 1523 Nov  5  2015 /opt/TurboVNC/bin/vncviewer
</pre>
</code>
<br>
<li>Mac OSX</li>
<br>
For Mac users, download <a href="https://sourceforge.net/projects/turbovnc/files/2.0.1/TurboVNC-2.0.1-OracleJava.dmg/download">TurboVNC-2.0.1-OracleJava.dmg</a>. The "OracleJava" TurboVNC package is now the default Mac package, since Oracle Java performs much better than Apple's (deprecated) Java distribution on OS X 10.10 "Yosemite" and later. Contact us if you need any help.
<br>
<li>Windows</li>
<br>
Download <a href="https://sourceforge.net/projects/turbovnc/files/2.0.1/TurboVNC64-2.0.1.exe/download">TurboVNC64-2.0.1.exe</a> and install it on your laptop. When asked where to install it, make sure to install it in <b>/c/Program Files/TurboVNC/</b> so you can easily use our script to visualize data. Contact us if you need any help.
<br>
</ul>
<br>
<br>
<h4 id="ConnectViz2">Connect to viz2</h4>
<br>
To make use of the remote visualization machine (viz2), you need to use TurboVNC (and you do not connect using ssh).
<br>
Clone GEF4530 repository (if you haven't done it yet). On your laptop terminal or machine desktop (use a git bash terminal on Windows):
<code>
<pre>
git clone https://github.uio.no/annefou/GEF4530.git
</pre>
</code>
The previous command (git clone) needs to be done once only. Then every time you wish to open a new terminal on viz2:
<code>
<pre>
cd GEF4530/setup
git pull
./norstoreVizWin.sh viz2 0
</pre>
</code>
or

<code>
<pre>
cd GEF4530/setup
git pull
./norstoreVizWin.sh viz2 1
</pre>
</code>
The last parameter (0 or 1) indicates which GPU to use on the viz2 machine.
<br>
Please note that on Linux system, it expects vncviewer (part of turboVNC) to be in /opt/TurboVNC/bin/. Edit the script if it is in a different location on your system (seek for help if you have problems).
<br>
The first time you launch <b>norstoreVizWin.sh</b>, you will be asked to define a password for TurboVNC. Choose a password you can remember as you will have to enter it for every remote visualization session.
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</body>
</html>
